#### 小爱同学课程表

##### 相关说明

​	小爱同学课程表，安装好插件后，默认会提供两个函数，按照文档说明，第一个函数用来提取页面的课程表信息，第二个函数用来解析数据。运行函数后会发现，弹出的页面中会包含课程信息，所以不再需要编写第一个函数，需要做的是将课程信息解析出来。

​	第二个函数名为`scheduleHtmlParser`，会接收到一个参数，该参数是由服务器解析好后传入进行来。传入进来的值为第一个函数的返回值。第二个函数内置`cheerio`库，该库是服务器版本的jQuery，实际操作与jq类似，可以参考文档进行学习。

​	取出整个`table`，可以只取出`table`中的`td`元素，该元素就是每个具体课程的信息。在实际操作中，可能`td`中不仅仅包含一组相似的节点，（如：全部都由div包裹）。在我的课表中存在`span`标签用来给该课加上标记。在进行信息解析时可以将该标签去掉，不影响数据的解析。

​	有的课程名有两个，在进行遍历的时候，可以不用管他，后面进行数据匹配时，将该数据进行选择去掉即可。

##### 解析数据

​	对`br`进行上一个节点的取值（该课表利用br去隔开标签和数据），对该数组进行遍历，得到的元素为br的上一个元素的信息，此时课程名数据在该节点。其他信息还包裹在节点中，未能一次取出。可利用不同标签的不同的`type`属性进行筛选。新建一个局部对象，将筛选出来的值暂时存入，后待数据解析完成`push`到一个数组中，由于`cheerio`会将空白元素（类似于tbody中的 <text> <element>）所以在遍历时，遍历的数量会是真正有数据的节点的两倍（大概，有的会少一个）。所以生成的总数组会存在三到四遍相同的数据，在此进行重复数去取出即可。

##### 生成数据

​	接下来的方法是取出的数据，对数据进行切片以及按照文档要求生成相应的数据要求。

```
//周次: "11-16(周)[06-07-08-09节]"
```

​	这种数据中存在周次及上课的节数，该做的事情是将数据进行切片进行遍历，以形成正确的数据格式。在这里可以对周次进行判断，如课程名称有两个值的是没有周次的，在此直接忽略即可。由于每个`td`不止有一个课程信息，可以根据课程表中分隔符继续对数据的分割，也不知道一个td中最多包含几门课程，在此可以生成五个对象去存数据。

​	将生成好的数据进行组合，返回给服务器。